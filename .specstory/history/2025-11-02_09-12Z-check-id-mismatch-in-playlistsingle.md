<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- cursor Session 4ce4f854-9d6f-4368-b84b-844e80e90c49 (2025-11-02 09:12Z) -->

# Check id mismatch in playlistSingle (2025-11-02 09:12Z)

_**User (2025-11-02 07:09Z)**_

check id for mismatch on playlistSingle is failing here

---

_**Agent (model default, mode Agent)**_



---


Inspecting `checkForIdMismatches` in `PlaylistSingle.vue` around line 1077.


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: src/views/playlists/PlaylistSingle.vue</summary>

</details>
</tool-use>

---



---

At line 1077, accessing `playlistAlbum.id` when `playlistAlbum` may be null. Adding a null check before accessing the property.


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: src/views/playlists/PlaylistSingle.vue</summary>

</details>
</tool-use>

---



---

Adding a null check to skip null albums before accessing `playlistAlbum.id`.


---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: src/views/playlists/PlaylistSingle.vue</summary>

**Chunk 1**
Lines added: 4, lines removed: undefined

```diff
@@ -1075,4 +1075,8 @@
      
      for (const playlistAlbum of allAlbumsFromPlaylist) {
+       if (!playlistAlbum || !playlistAlbum.id) {
+         continue; // Skip null or invalid albums
+       }
+       
        albumIdToPlaylistAlbum.set(playlistAlbum.id, playlistAlbum);
        const dbAlbumData = await fetchAlbumsData([playlistAlbum.id]);
```

</details>

</tool-use>

---



---

Checking for linting errors in this file:


---

<tool-use data-tool-type="generic" data-tool-name="read_lints">
<details>
          <summary>Tool use: **read_lints** • Read lints for 1 file</summary>
      
Lint paths:

- `src/views/playlists/PlaylistSingle.vue`

Lint results


**No lint errors found**
</details>
</tool-use>

---



---

Added a null check to skip null or invalid albums before accessing their properties. This prevents the error when `loadAlbumsBatched` returns null for albums that couldn't be loaded.

The fix ensures that:
1. We skip any null entries in `allAlbumsFromPlaylist`
2. We only process albums with valid `id` properties
3. Only valid albums are added to `albumsInDb` for further processing

This should resolve the error you're seeing. The ID mismatch check will now handle cases where some albums fail to load from Spotify.

---

_**User (2025-11-02 07:09Z)**_

so when we do the batch processing, here for example it only finds 106 albums out of 111. how can I find out which those 5 are?

---

_**Agent (model default, mode Ask)**_



---


Tracing the logic to identify where albums are filtered out:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: src/views/playlists/PlaylistSingle.vue</summary>

</details>
</tool-use>

---



---

Albums are filtered at three points:

1. **Lines 1077-1079**: Skip null/invalid albums from Spotify load
2. **Lines 1084-1087**: Skip albums not in the database
3. **Lines 1100-1112**: Skip albums without a valid `artistId`

To identify the missing 5, track which albums are filtered at each stage. Here's code you can add:

```javascript:src/views/playlists/PlaylistSingle.vue
async function checkForIdMismatches() {
  // ... existing code ...
  
  try {
    // Step 1: Load all albums from the playlist
    currentlyProcessingAlbum.value = 'Loading playlist albums...';
    const allAlbumsFromPlaylist = await loadAlbumsBatched(sortedAlbumIds.value);
    
    // Track skipped albums
    const skippedAlbums = {
      nullAlbums: [],
      notInDb: [],
      noArtistId: []
    };
    
    // Step 2: Identify which albums exist in the database
    currentlyProcessingAlbum.value = 'Checking which albums are in database...';
    const albumsInDb = [];
    const albumIdToPlaylistAlbum = new Map();
    
    for (const playlistAlbum of allAlbumsFromPlaylist) {
      if (!playlistAlbum || !playlistAlbum.id) {
        // Track which album IDs failed to load
        const albumIndex = allAlbumsFromPlaylist.indexOf(playlistAlbum);
        skippedAlbums.nullAlbums.push(sortedAlbumIds.value[albumIndex] || 'unknown');
        continue;
      }
      
      albumIdToPlaylistAlbum.set(playlistAlbum.id, playlistAlbum);
      const dbAlbumData = await fetchAlbumsData([playlistAlbum.id]);
      
      if (dbAlbumData[playlistAlbum.id] !== null) {
        albumsInDb.push(playlistAlbum);
      } else {
        skippedAlbums.notInDb.push({
          id: playlistAlbum.id,
          name: playlistAlbum.name,
          artist: playlistAlbum.artists?.[0]?.name || 'Unknown'
        });
      }
    }
    
    // Step 3: Group albums by artist to minimize API calls
    const artistMap = new Map();
    
    for (const album of albumsInDb) {
      const artistId = album.artists[0]?.id;
      const artistName = album.artists[0]?.name || 'Unknown Artist';
      
      if (artistId) {
        if (!artistMap.has(artistId)) {
          artistMap.set(artistId, {
            artistId,
            artistName,
            albums: []
          });
        }
        artistMap.get(artistId).albums.push(album);
      } else {
        skippedAlbums.noArtistId.push({
          id: album.id,
          name: album.name,
          artist: artistName
        });
      }
    }
    
    // Log skipped albums to console
    if (skippedAlbums.nullAlbums.length > 0) {
      console.warn('Albums that failed to load from Spotify:', skippedAlbums.nullAlbums);
    }
    if (skippedAlbums.notInDb.length > 0) {
      console.warn('Albums not in database:', skippedAlbums.notInDb);
    }
    if (skippedAlbums.noArtistId.length > 0) {
      console.warn('Albums without artist ID:', skippedAlbums.noArtistId);
    }
    
    // Calculate total skipped
    const totalSkipped = skippedAlbums.nullAlbums.length + skippedAlbums.notInDb.length + skippedAlbums.noArtistId.length;
    console.log(`Skipped ${totalSkipped} albums out of ${sortedAlbumIds.value.length} total`);
    
    // ... rest of existing code ...
```

This logs:
- Albums that failed to load from Spotify
- Albums not in the database
- Albums without a valid artist ID

After running the check, check the browser console to see which albums were skipped and at which stage. The count of 106 is likely from albums without valid `artistId` entries, so those would be in `skippedAlbums.noArtistId`.

---

_**User (2025-11-02 07:09Z)**_

could we add a 'Check invalid' that surfaces those in the UI?

---

_**Agent (model default, mode Ask)**_



---


Reviewing the mismatch report structure to mirror it for invalid albums:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: src/views/playlists/PlaylistSingle.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: src/views/playlists/PlaylistSingle.vue</summary>

</details>
</tool-use>

---



---

Proposed changes to add a "Check Invalid" feature that surfaces skipped albums in the UI:

**1. Add state variables for invalid albums (after the mismatch checking state):**

```javascript:src/views/playlists/PlaylistSingle.vue
// ID mismatch checking state
const checkingMismatches = ref(false);
const mismatchReport = ref([]);
const showMismatchReport = ref(false);
const mismatchCheckStartTime = ref(null);
const mismatchCheckProgress = ref({ current: 0, total: 0, currentArtist: null });

// Invalid albums checking state
const checkingInvalid = ref(false);
const invalidAlbumsReport = ref({
  nullAlbums: [],
  notInDb: [],
  noArtistId: []
});
const showInvalidReport = ref(false);
```

**2. Add the check function (after `checkForIdMismatches`):**

```javascript:src/views/playlists/PlaylistSingle.vue
async function checkForInvalidAlbums() {
  if (!sortedAlbumIds.value.length || !user.value) {
    return;
  }

  checkingInvalid.value = true;
  invalidAlbumsReport.value = {
    nullAlbums: [],
    notInDb: [],
    noArtistId: []
  };
  showInvalidReport.value = false;
  error.value = null;
  successMessage.value = '';

  try {
    currentlyProcessingAlbum.value = 'Loading playlist albums...';
    const allAlbumsFromPlaylist = await loadAlbumsBatched(sortedAlbumIds.value);
    
    currentlyProcessingAlbum.value = 'Checking albums...';
    const albumsInDb = [];
    
    // Track which album IDs correspond to each position
    for (let i = 0; i < sortedAlbumIds.value.length; i++) {
      const albumId = sortedAlbumIds.value[i];
      const playlistAlbum = allAlbumsFromPlaylist[i];
      
      if (!playlistAlbum || !playlistAlbum.id) {
        // Album failed to load from Spotify
        invalidAlbumsReport.value.nullAlbums.push({
          id: albumId,
          error: 'Failed to load from Spotify'
        });
        continue;
      }
      
      const dbAlbumData = await fetchAlbumsData([playlistAlbum.id]);
      
      if (dbAlbumData[playlistAlbum.id] === null) {
        // Album not in database
        invalidAlbumsReport.value.notInDb.push({
          id: playlistAlbum.id,
          name: playlistAlbum.name,
          artist: playlistAlbum.artists?.[0]?.name || 'Unknown Artist',
          cover: playlistAlbum.images?.[1]?.url || playlistAlbum.images?.[0]?.url || ''
        });
      } else {
        albumsInDb.push(playlistAlbum);
      }
    }
    
    // Check for albums without artist ID
    for (const album of albumsInDb) {
      const artistId = album.artists[0]?.id;
      if (!artistId) {
        invalidAlbumsReport.value.noArtistId.push({
          id: album.id,
          name: album.name,
          artist: album.artists[0]?.name || 'Unknown Artist',
          cover: album.images?.[1]?.url || album.images?.[0]?.url || ''
        });
      }
    }
    
    showInvalidReport.value = true;
    
    const totalInvalid = invalidAlbumsReport.value.nullAlbums.length + 
                         invalidAlbumsReport.value.notInDb.length + 
                         invalidAlbumsReport.value.noArtistId.length;
    
    if (totalInvalid === 0) {
      successMessage.value = 'No invalid albums found! All albums are valid.';
    } else {
      successMessage.value = `Found ${totalInvalid} invalid album(s). See report below.`;
    }
  } catch (err) {
    console.error('Error checking for invalid albums:', err);
    error.value = err.message || 'Failed to check for invalid albums';
  } finally {
    checkingInvalid.value = false;
    currentlyProcessingAlbum.value = null;
  }
}
```

**3. Add the button in the UI (near the "Check for ID Mismatches" button):**

```javascript:src/views/playlists/PlaylistSingle.vue
      <BaseButton 
        @click="checkForIdMismatches"
        :disabled="checkingMismatches || loading || batchProcessingAlbums"
        customClass="bg-delft-blue text-white hover:bg-blue-700"
      >
        <template #icon-left>
          <ArrowPathIcon v-if="checkingMismatches" class="h-5 w-5 animate-spin" />
        </template>
        {{ checkingMismatches ? 'Checking...' : 'Check for ID Mismatches' }}
      </BaseButton>
      <BaseButton 
        @click="checkForInvalidAlbums"
        :disabled="checkingInvalid || loading || batchProcessingAlbums"
        customClass="bg-red-600 text-white hover:bg-red-700"
      >
        <template #icon-left>
          <ArrowPathIcon v-if="checkingInvalid" class="h-5 w-5 animate-spin" />
        </template>
        {{ checkingInvalid ? 'Checking...' : 'Check Invalid' }}
      </BaseButton>
```

**4. Add the invalid albums report UI (after the ID Mismatch Report section):**

```javascript:src/views/playlists/PlaylistSingle.vue
    <!-- Invalid Albums Report -->
    <div v-if="showInvalidReport && (invalidAlbumsReport.nullAlbums.length > 0 || invalidAlbumsReport.notInDb.length > 0 || invalidAlbumsReport.noArtistId.length > 0)" class="mb-6 bg-red-50 border-2 border-red-400 rounded-lg p-6">
      <h2 class="text-xl font-semibold mb-4 text-red-800">
        Invalid Albums Report
      </h2>
      
      <!-- Failed to Load from Spotify -->
      <div v-if="invalidAlbumsReport.nullAlbums.length > 0" class="mb-6">
        <h3 class="text-lg font-semibold mb-3 text-red-700">
          Failed to Load from Spotify ({{ invalidAlbumsReport.nullAlbums.length }})
        </h3>
        <div class="bg-white rounded-lg p-4 border border-red-300">
          <ul class="space-y-2">
            <li v-for="(album, index) in invalidAlbumsReport.nullAlbums" :key="index" class="text-sm">
              <span class="font-mono text-gray-600">{{ album.id }}</span>
              <span class="text-gray-500 ml-2">- {{ album.error }}</span>
            </li>
          </ul>
        </div>
      </div>
      
      <!-- Not in Database -->
      <div v-if="invalidAlbumsReport.notInDb.length > 0" class="mb-6">
        <h3 class="text-lg font-semibold mb-3 text-red-700">
          Not in Database ({{ invalidAlbumsReport.notInDb.length }})
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          <div 
            v-for="(album, index) in invalidAlbumsReport.notInDb" 
            :key="index"
            class="bg-white rounded-lg p-4 border border-red-300"
          >
            <div class="mb-3">
              <img 
                v-if="album.cover" 
                :src="album.cover" 
                :alt="album.name"
                class="w-full h-auto rounded object-cover mb-2 shadow-sm"
              />
              <div v-else class="w-full h-48 bg-gray-200 rounded flex items-center justify-center mb-2">
                <span class="text-gray-400 text-xs">No Cover</span>
              </div>
            </div>
            <div class="space-y-1.5">
              <div>
                <p class="text-xs font-medium text-gray-500 mb-0.5">Artist</p>
                <p class="text-sm font-semibold text-gray-900">{{ album.artist }}</p>
              </div>
              <div>
                <p class="text-xs font-medium text-gray-500 mb-0.5">Title</p>
                <p class="text-sm font-semibold text-gray-900">{{ album.name }}</p>
              </div>
              <div>
                <p class="text-xs font-medium text-gray-500 mb-0.5">ID</p>
                <p class="text-xs font-mono text-gray-600 break-all">{{ album.id }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- No Artist ID -->
      <div v-if="invalidAlbumsReport.noArtistId.length > 0" class="mb-6">
        <h3 class="text-lg font-semibold mb-3 text-red-700">
          Missing Artist ID ({{ invalidAlbumsReport.noArtistId.length }})
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          <div 
            v-for="(album, index) in invalidAlbumsReport.noArtistId" 
            :key="index"
            class="bg-white rounded-lg p-4 border border-red-300"
          >
            <div class="mb-3">
              <img 
                v-if="album.cover" 
                :src="album.cover" 
                :alt="album.name"
                class="w-full h-auto rounded object-cover mb-2 shadow-sm"
              />
              <div v-else class="w-full h-48 bg-gray-200 rounded flex items-center justify-center mb-2">
                <span class="text-gray-400 text-xs">No Cover</span>
              </div>
            </div>
            <div class="space-y-1.5">
              <div>
                <p class="text-xs font-medium text-gray-500 mb-0.5">Artist</p>
                <p class="text-sm font-semibold text-gray-900">{{ album.artist }}</p>
              </div>
              <div>
                <p class="text-xs font-medium text-gray-500 mb-0.5">Title</p>
                <p class="text-sm font-semibold text-gray-900">{{ album.name }}</p>
              </div>
              <div>
                <p class="text-xs font-medium text-gray-500 mb-0.5">ID</p>
                <p class="text-xs font-mono text-gray-600 break-all">{{ album.id }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <p class="mt-4 text-sm text-red-700">
        These albums have issues that prevent them from being processed in the ID mismatch check.
        Albums not in database may need to be added. Albums without artist IDs may have data issues.
      </p>
    </div>
```

This adds:
- A "Check Invalid" button that runs the check
- A report showing albums grouped by issue:
  - Failed to load from Spotify
  - Not in database
  - Missing artist ID

Each section shows album details (cover, name, artist, ID) to identify which albums need attention.

---

_**User (2025-11-02 07:09Z)**_

ok add this

---

_**Agent (model default, mode Agent)**_



---


Adding the "Check Invalid" feature back: state variables, function, button, and UI report.


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: src/views/playlists/PlaylistSingle.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: src/views/playlists/PlaylistSingle.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: src/views/playlists/PlaylistSingle.vue</summary>

</details>
</tool-use>

---



---

Adding the "Check Invalid" feature:


---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: src/views/playlists/PlaylistSingle.vue</summary>

**Chunk 1**
Lines added: 9, lines removed: undefined

```diff
@@ -316,4 +316,13 @@
  const mismatchCheckStartTime = ref(null);
  const mismatchCheckProgress = ref({ current: 0, total: 0, currentArtist: null });
+ 
+ // Invalid albums checking state
+ const checkingInvalid = ref(false);
+ const invalidAlbumsReport = ref({
+   nullAlbums: [],
+   notInDb: [],
+   noArtistId: []
+ });
+ const showInvalidReport = ref(false);
  
  // Last.fm loved tracks data
```

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: src/views/playlists/PlaylistSingle.vue</summary>

**Chunk 1**
Lines added: 84, lines removed: undefined

```diff
@@ -1238,4 +1238,88 @@
    }
  }
+ 
+ async function checkForInvalidAlbums() {
+   if (!sortedAlbumIds.value.length || !user.value) {
+     return;
+   }
+ 
+   checkingInvalid.value = true;
+   invalidAlbumsReport.value = {
+     nullAlbums: [],
+     notInDb: [],
+     noArtistId: []
+   };
+   showInvalidReport.value = false;
+   error.value = null;
+   successMessage.value = '';
+ 
+   try {
+     currentlyProcessingAlbum.value = 'Loading playlist albums...';
+     const allAlbumsFromPlaylist = await loadAlbumsBatched(sortedAlbumIds.value);
+     
+     currentlyProcessingAlbum.value = 'Checking albums...';
+     const albumsInDb = [];
+     
+     // Track which album IDs correspond to each position
+     for (let i = 0; i &lt; sortedAlbumIds.value.length; i++) {
+       const albumId = sortedAlbumIds.value[i];
+       const playlistAlbum = allAlbumsFromPlaylist[i];
+       
+       if (!playlistAlbum || !playlistAlbum.id) {
+         // Album failed to load from Spotify
+         invalidAlbumsReport.value.nullAlbums.push({
+           id: albumId,
+           error: 'Failed to load from Spotify'
+         });
+         continue;
+       }
+       
+       const dbAlbumData = await fetchAlbumsData([playlistAlbum.id]);
+       
+       if (dbAlbumData[playlistAlbum.id] === null) {
+         // Album not in database
+         invalidAlbumsReport.value.notInDb.push({
+           id: playlistAlbum.id,
+           name: playlistAlbum.name,
+           artist: playlistAlbum.artists?.[0]?.name || 'Unknown Artist',
+           cover: playlistAlbum.images?.[1]?.url || playlistAlbum.images?.[0]?.url || ''
+         });
+       } else {
+         albumsInDb.push(playlistAlbum);
+       }
+     }
+     
+     // Check for albums without artist ID
+     for (const album of albumsInDb) {
+       const artistId = album.artists[0]?.id;
+       if (!artistId) {
+         invalidAlbumsReport.value.noArtistId.push({
+           id: album.id,
+           name: album.name,
+           artist: album.artists[0]?.name || 'Unknown Artist',
+           cover: album.images?.[1]?.url || album.images?.[0]?.url || ''
+         });
+       }
+     }
+     
+     showInvalidReport.value = true;
+     
+     const totalInvalid = invalidAlbumsReport.value.nullAlbums.length + 
+                          invalidAlbumsReport.value.notInDb.length + 
+                          invalidAlbumsReport.value.noArtistId.length;
+     
+     if (totalInvalid === 0) {
+       successMessage.value = 'No invalid albums found! All albums are valid.';
+     } else {
+       successMessage.value = &#96;Found ${totalInvalid} invalid album(s). See report below.&#96;;
+     }
+   } catch (err) {
+     console.error('Error checking for invalid albums:', err);
+     error.value = err.message || 'Failed to check for invalid albums';
+   } finally {
+     checkingInvalid.value = false;
+     currentlyProcessingAlbum.value = null;
+   }
+ }
  
  const handleCreateMapping = async (mismatch) =&gt; {
```

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: src/views/playlists/PlaylistSingle.vue</summary>

**Chunk 1**
Lines added: 10, lines removed: undefined

```diff
@@ -1464,4 +1464,14 @@
          {{ checkingMismatches ? 'Checking...' : 'Check for ID Mismatches' }}
        &lt;/BaseButton&gt;
+       &lt;BaseButton 
+         @click="checkForInvalidAlbums"
+         :disabled="checkingInvalid || loading || batchProcessingAlbums"
+         customClass="bg-red-600 text-white hover:bg-red-700"
+       &gt;
+         &lt;template #icon-left&gt;
+           &lt;ArrowPathIcon v-if="checkingInvalid" class="h-5 w-5 animate-spin" /&gt;
+         &lt;/template&gt;
+         {{ checkingInvalid ? 'Checking...' : 'Check Invalid' }}
+       &lt;/BaseButton&gt;
      &lt;/div&gt;
  
```

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: src/views/playlists/PlaylistSingle.vue</summary>

**Chunk 1**
Lines added: 107, lines removed: undefined

```diff
@@ -1620,4 +1620,111 @@
        &lt;/p&gt;
      &lt;/div&gt;
+ 
+     &lt;!-- Invalid Albums Report --&gt;
+     &lt;div v-if="showInvalidReport &amp;&amp; (invalidAlbumsReport.nullAlbums.length &gt; 0 || invalidAlbumsReport.notInDb.length &gt; 0 || invalidAlbumsReport.noArtistId.length &gt; 0)" class="mb-6 bg-red-50 border-2 border-red-400 rounded-lg p-6"&gt;
+       &lt;h2 class="text-xl font-semibold mb-4 text-red-800"&gt;
+         Invalid Albums Report
+       &lt;/h2&gt;
+       
+       &lt;!-- Failed to Load from Spotify --&gt;
+       &lt;div v-if="invalidAlbumsReport.nullAlbums.length &gt; 0" class="mb-6"&gt;
+         &lt;h3 class="text-lg font-semibold mb-3 text-red-700"&gt;
+           Failed to Load from Spotify ({{ invalidAlbumsReport.nullAlbums.length }})
+         &lt;/h3&gt;
+         &lt;div class="bg-white rounded-lg p-4 border border-red-300"&gt;
+           &lt;ul class="space-y-2"&gt;
+             &lt;li v-for="(album, index) in invalidAlbumsReport.nullAlbums" :key="index" class="text-sm"&gt;
+               &lt;span class="font-mono text-gray-600"&gt;{{ album.id }}&lt;/span&gt;
+               &lt;span class="text-gray-500 ml-2"&gt;- {{ album.error }}&lt;/span&gt;
+             &lt;/li&gt;
+           &lt;/ul&gt;
+         &lt;/div&gt;
+       &lt;/div&gt;
+       
+       &lt;!-- Not in Database --&gt;
+       &lt;div v-if="invalidAlbumsReport.notInDb.length &gt; 0" class="mb-6"&gt;
+         &lt;h3 class="text-lg font-semibold mb-3 text-red-700"&gt;
+           Not in Database ({{ invalidAlbumsReport.notInDb.length }})
+         &lt;/h3&gt;
+         &lt;div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"&gt;
+           &lt;div 
+             v-for="(album, index) in invalidAlbumsReport.notInDb" 
+             :key="index"
+             class="bg-white rounded-lg p-4 border border-red-300"
+           &gt;
+             &lt;div class="mb-3"&gt;
+               &lt;img 
+                 v-if="album.cover" 
+                 :src="album.cover" 
+                 :alt="album.name"
+                 class="w-full h-auto rounded object-cover mb-2 shadow-sm"
+               /&gt;
+               &lt;div v-else class="w-full h-48 bg-gray-200 rounded flex items-center justify-center mb-2"&gt;
+                 &lt;span class="text-gray-400 text-xs"&gt;No Cover&lt;/span&gt;
+               &lt;/div&gt;
+             &lt;/div&gt;
+             &lt;div class="space-y-1.5"&gt;
+               &lt;div&gt;
+                 &lt;p class="text-xs font-medium text-gray-500 mb-0.5"&gt;Artist&lt;/p&gt;
+                 &lt;p class="text-sm font-semibold text-gray-900"&gt;{{ album.artist }}&lt;/p&gt;
+               &lt;/div&gt;
+               &lt;div&gt;
+                 &lt;p class="text-xs font-medium text-gray-500 mb-0.5"&gt;Title&lt;/p&gt;
+                 &lt;p class="text-sm font-semibold text-gray-900"&gt;{{ album.name }}&lt;/p&gt;
+               &lt;/div&gt;
+               &lt;div&gt;
+                 &lt;p class="text-xs font-medium text-gray-500 mb-0.5"&gt;ID&lt;/p&gt;
+                 &lt;p class="text-xs font-mono text-gray-600 break-all"&gt;{{ album.id }}&lt;/p&gt;
+               &lt;/div&gt;
+             &lt;/div&gt;
+           &lt;/div&gt;
+         &lt;/div&gt;
+       &lt;/div&gt;
+       
+       &lt;!-- No Artist ID --&gt;
+       &lt;div v-if="invalidAlbumsReport.noArtistId.length &gt; 0" class="mb-6"&gt;
+         &lt;h3 class="text-lg font-semibold mb-3 text-red-700"&gt;
+           Missing Artist ID ({{ invalidAlbumsReport.noArtistId.length }})
+         &lt;/h3&gt;
+         &lt;div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"&gt;
+           &lt;div 
+             v-for="(album, index) in invalidAlbumsReport.noArtistId" 
+             :key="index"
+             class="bg-white rounded-lg p-4 border border-red-300"
+           &gt;
+             &lt;div class="mb-3"&gt;
+               &lt;img 
+                 v-if="album.cover" 
+                 :src="album.cover" 
+                 :alt="album.name"
+                 class="w-full h-auto rounded object-cover mb-2 shadow-sm"
+               /&gt;
+               &lt;div v-else class="w-full h-48 bg-gray-200 rounded flex items-center justify-center mb-2"&gt;
+                 &lt;span class="text-gray-400 text-xs"&gt;No Cover&lt;/span&gt;
+               &lt;/div&gt;
+             &lt;/div&gt;
+             &lt;div class="space-y-1.5"&gt;
+               &lt;div&gt;
+                 &lt;p class="text-xs font-medium text-gray-500 mb-0.5"&gt;Artist&lt;/p&gt;
+                 &lt;p class="text-sm font-semibold text-gray-900"&gt;{{ album.artist }}&lt;/p&gt;
+               &lt;/div&gt;
+               &lt;div&gt;
+                 &lt;p class="text-xs font-medium text-gray-500 mb-0.5"&gt;Title&lt;/p&gt;
+                 &lt;p class="text-sm font-semibold text-gray-900"&gt;{{ album.name }}&lt;/p&gt;
+               &lt;/div&gt;
+               &lt;div&gt;
+                 &lt;p class="text-xs font-medium text-gray-500 mb-0.5"&gt;ID&lt;/p&gt;
+                 &lt;p class="text-xs font-mono text-gray-600 break-all"&gt;{{ album.id }}&lt;/p&gt;
+               &lt;/div&gt;
+             &lt;/div&gt;
+           &lt;/div&gt;
+         &lt;/div&gt;
+       &lt;/div&gt;
+       
+       &lt;p class="mt-4 text-sm text-red-700"&gt;
+         These albums have issues that prevent them from being processed in the ID mismatch check.
+         Albums not in database may need to be added. Albums without artist IDs may have data issues.
+       &lt;/p&gt;
+     &lt;/div&gt;
      &lt;div v-if="tracksLoading" class="mb-4 text-center"&gt;
        &lt;p class="text-delft-blue"&gt;Loading tracklists...&lt;/p&gt;
```

</details>

</tool-use>

---



---

Checking for linting errors:


---

<tool-use data-tool-type="generic" data-tool-name="read_lints">
<details>
          <summary>Tool use: **read_lints** • Read lints for 1 file</summary>
      
Lint paths:

- `src/views/playlists/PlaylistSingle.vue`

Lint results


**No lint errors found**
</details>
</tool-use>

---



---

Added the "Check Invalid" feature.

1. **State variables** (lines 319-326):
   - `checkingInvalid` — tracks if the check is running
   - `invalidAlbumsReport` — stores invalid albums categorized by issue
   - `showInvalidReport` — controls report visibility

2. **`checkForInvalidAlbums` function** (lines 1241-1323):
   - Identifies albums that:
     - Failed to load from Spotify (null entries)
     - Are not in the database
     - Are missing artist IDs
   - Shows a success message with the count

3. **"Check Invalid" button** (lines 1466-1475):
   - Red button next to "Check for ID Mismatches"
   - Shows a loading spinner while checking
   - Disabled during other operations

4. **Invalid Albums Report UI** (lines 1623-1728):
   - Red-themed report section with three categories:
     - Failed to Load from Spotify — shows album IDs that failed
     - Not in Database — shows albums with covers, names, artists, and IDs
     - Missing Artist ID — shows albums without valid artist IDs
   - Each category displays only when it has items

Clicking "Check Invalid" identifies which albums are causing the 106 vs 111 discrepancy and shows them in a structured report.

---

_**User (2025-11-02 07:09Z)**_

no, it's returning no invalid, when we obvisouyl had 5 albums that the id mismatch check decided not to include. we need to be able to surface those 5 albums somehow.

---

_**Agent (model default, mode Agent)**_



---


Reviewing the ID mismatch check logic to identify where albums are filtered out, then updating `checkForInvalidAlbums` to match that logic and surface the missing albums.


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: src/views/playlists/PlaylistSingle.vue</summary>

</details>
</tool-use>

---



---

Updating `checkForInvalidAlbums` to mirror the ID mismatch check logic so it surfaces albums filtered out:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: src/views/playlists/PlaylistSingle.vue</summary>

</details>
</tool-use>

---



---

Rewriting `checkForInvalidAlbums` to match the ID mismatch check logic so it surfaces the filtered albums.


---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: src/views/playlists/PlaylistSingle.vue</summary>

**Chunk 1**
Lines added: 16, lines removed: 10

```diff
@@ -1255,27 +1255,33 @@
  
    try {
+     // Mirror the exact logic from checkForIdMismatches
+     // Step 1: Load all albums from the playlist
      currentlyProcessingAlbum.value = 'Loading playlist albums...';
      const allAlbumsFromPlaylist = await loadAlbumsBatched(sortedAlbumIds.value);
      
-     currentlyProcessingAlbum.value = 'Checking albums...';
+     // Step 2: Identify which albums exist in the database (same as mismatch check)
+     currentlyProcessingAlbum.value = 'Checking which albums are in database...';
      const albumsInDb = [];
-     
-     // Track which album IDs correspond to each position
-     for (let i = 0; i &lt; sortedAlbumIds.value.length; i++) {
-       const albumId = sortedAlbumIds.value[i];
-       const playlistAlbum = allAlbumsFromPlaylist[i];
-       
+     const albumIdToPlaylistAlbum = new Map();
+     
+     for (const playlistAlbum of allAlbumsFromPlaylist) {
        if (!playlistAlbum || !playlistAlbum.id) {
-         // Album failed to load from Spotify
+         // Find which original ID this corresponds to
+         const originalIndex = allAlbumsFromPlaylist.indexOf(playlistAlbum);
+         const originalId = sortedAlbumIds.value[originalIndex] || 'unknown';
          invalidAlbumsReport.value.nullAlbums.push({
-           id: albumId,
+           id: originalId,
            error: 'Failed to load from Spotify'
          });
          continue;
        }
        
+       albumIdToPlaylistAlbum.set(playlistAlbum.id, playlistAlbum);
        const dbAlbumData = await fetchAlbumsData([playlistAlbum.id]);
        
-       if (dbAlbumData[playlistAlbum.id] === null) {
+       if (dbAlbumData[playlistAlbum.id] !== null) {
+         // Album exists in DB - this is what would be checked
+         albumsInDb.push(playlistAlbum);
+       } else {
          // Album not in database
          invalidAlbumsReport.value.notInDb.push({
```

**Chunk 2**
Lines added: 26, lines removed: 5

```diff
@@ -1285,21 +1291,42 @@
            cover: playlistAlbum.images?.[1]?.url || playlistAlbum.images?.[0]?.url || ''
          });
-       } else {
-         albumsInDb.push(playlistAlbum);
        }
      }
      
-     // Check for albums without artist ID
+     // Step 3: Group albums by artist (same as mismatch check)
+     // This is where albums without artistId get filtered out
+     const artistMap = new Map();
+     
      for (const album of albumsInDb) {
        const artistId = album.artists[0]?.id;
-       if (!artistId) {
+       const artistName = album.artists[0]?.name || 'Unknown Artist';
+       
+       if (artistId) {
+         // Album has artistId - would be included in mismatch check
+         if (!artistMap.has(artistId)) {
+           artistMap.set(artistId, {
+             artistId,
+             artistName,
+             albums: []
+           });
+         }
+         artistMap.get(artistId).albums.push(album);
+       } else {
+         // Album doesn't have artistId - gets filtered out in mismatch check
          invalidAlbumsReport.value.noArtistId.push({
            id: album.id,
            name: album.name,
-           artist: album.artists[0]?.name || 'Unknown Artist',
+           artist: artistName,
            cover: album.images?.[1]?.url || album.images?.[0]?.url || ''
          });
        }
      }
+     
+     // Log for debugging
+     console.log('Total albums in playlist:', sortedAlbumIds.value.length);
+     console.log('Albums loaded from Spotify:', allAlbumsFromPlaylist.length);
+     console.log('Albums in database:', albumsInDb.length);
+     console.log('Albums with artistId (would be checked):', Array.from(artistMap.values()).reduce((sum, artist) =&gt; sum + artist.albums.length, 0));
+     console.log('Albums without artistId (filtered out):', invalidAlbumsReport.value.noArtistId.length);
      
      showInvalidReport.value = true;
```

</details>

</tool-use>

---



---

Fixing the tracking of which original album IDs correspond to failed loads:


---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: src/views/playlists/PlaylistSingle.vue</summary>

**Chunk 1**
Lines added: 7, lines removed: 5

```diff
@@ -1265,11 +1265,13 @@
      const albumIdToPlaylistAlbum = new Map();
      
-     for (const playlistAlbum of allAlbumsFromPlaylist) {
+     // Use index-based loop to track original album IDs
+     for (let i = 0; i &lt; sortedAlbumIds.value.length; i++) {
+       const originalAlbumId = sortedAlbumIds.value[i];
+       const playlistAlbum = allAlbumsFromPlaylist[i];
+       
        if (!playlistAlbum || !playlistAlbum.id) {
-         // Find which original ID this corresponds to
-         const originalIndex = allAlbumsFromPlaylist.indexOf(playlistAlbum);
-         const originalId = sortedAlbumIds.value[originalIndex] || 'unknown';
+         // Album failed to load from Spotify
          invalidAlbumsReport.value.nullAlbums.push({
-           id: originalId,
+           id: originalAlbumId,
            error: 'Failed to load from Spotify'
          });
```

</details>

</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="read_lints">
<details>
          <summary>Tool use: **read_lints** • Read lints for 1 file</summary>
      
Lint paths:

- `src/views/playlists/PlaylistSingle.vue`

Lint results


**No lint errors found**
</details>
</tool-use>

---



---

Updated `checkForInvalidAlbums` to mirror the ID mismatch check logic. Changes:

1. **Index-based tracking**: Uses an index loop to match original album IDs with loaded albums.
2. **Mirrors the mismatch check flow**: Follows the same three steps (load, check DB, group by artist) to identify filtered albums.
3. **Console logging**: Logs counts for debugging.

The function now identifies albums filtered out during the ID mismatch check:
- Albums that failed to load from Spotify
- Albums not in the database  
- Albums in the database but without an `artistId` (the likely source of the 5 filtered albums)

Run "Check Invalid" again; it should surface those 5 albums. The console logs will show where albums are being filtered.

---

_**User (2025-11-02 07:09Z)**_

no. still returning no invalid. this code is the key. this is the one that the 'check for id mismatch' uses to bypass null or invalid. we need to know those.

---

_**Agent (model default, mode Agent)**_



---


Updating the function to capture albums skipped by that exact check—null entries or entries without an `id`:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: src/views/playlists/PlaylistSingle.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="codebase_search">
<details>
                <summary>Tool use: **codebase_search** • Searched codebase "How does loadAlbumsBatched work and what does it return?" • **11** results</summary>
            
| File | Lines |
|------|-------|
| `src/composables/useUserSpotifyApi.js` | L4-601 |
| `src/composables/useAlbumsData.js` | L25-651 |
| `src/composables/useSpotifyApi.js` | L1-231 |
| `src/views/playlists/PlaylistSingle.vue` | L955-1009 |
| `src/views/playlists/PlaylistSingle.vue` | L488-532 |
| `src/views/playlists/PlaylistSingle.vue` | L525-572 |
| `src/views/playlists/PlaylistSingle.vue` | L1061-1108 |
| `src/views/playlists/PlaylistSingle.vue` | L1241-1299 |
| `src/views/playlists/PlaylistSingle.vue` | L453-494 |
| `src/views/music/ArtistView.vue` | L142-199 |
| `src/views/playlists/PlaylistSingle.vue` | L1006-1067 |

</details>
</tool-use>

---



---

Matching returned albums by `id` to the original album IDs, since Spotify may filter out invalid albums. Rewriting the function:


---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: src/views/playlists/PlaylistSingle.vue</summary>

**Chunk 1**
Lines added: 27, lines removed: 12

```diff
@@ -1260,20 +1260,35 @@
      const allAlbumsFromPlaylist = await loadAlbumsBatched(sortedAlbumIds.value);
      
-     // Step 2: Identify which albums exist in the database (same as mismatch check)
-     currentlyProcessingAlbum.value = 'Checking which albums are in database...';
-     const albumsInDb = [];
-     const albumIdToPlaylistAlbum = new Map();
-     
-     // Use index-based loop to track original album IDs
-     for (let i = 0; i &lt; sortedAlbumIds.value.length; i++) {
-       const originalAlbumId = sortedAlbumIds.value[i];
-       const playlistAlbum = allAlbumsFromPlaylist[i];
-       
-       if (!playlistAlbum || !playlistAlbum.id) {
-         // Album failed to load from Spotify
+     // Create a map of album ID -&gt; album object from the loaded albums
+     const loadedAlbumsMap = new Map();
+     for (const album of allAlbumsFromPlaylist) {
+       if (album &amp;&amp; album.id) {
+         loadedAlbumsMap.set(album.id, album);
+       }
+     }
+     
+     // Step 2: Check which original album IDs are missing from the loaded results
+     // These are albums that failed to load from Spotify
+     for (const originalAlbumId of sortedAlbumIds.value) {
+       if (!loadedAlbumsMap.has(originalAlbumId)) {
          invalidAlbumsReport.value.nullAlbums.push({
            id: originalAlbumId,
            error: 'Failed to load from Spotify'
          });
+       }
+     }
+     
+     // Step 3: Now mirror the exact checkForIdMismatches logic
+     // Identify which albums exist in the database (same as mismatch check)
+     currentlyProcessingAlbum.value = 'Checking which albums are in database...';
+     const albumsInDb = [];
+     const albumIdToPlaylistAlbum = new Map();
+     
+     // This is the EXACT same loop as in checkForIdMismatches
+     for (const playlistAlbum of allAlbumsFromPlaylist) {
+       // THIS IS THE KEY CHECK - albums that fail this are the ones we need to track
+       if (!playlistAlbum || !playlistAlbum.id) {
+         // This album was filtered out - but we already caught it above in nullAlbums
+         // So we can continue here without tracking again
          continue;
        }
```

**Chunk 2**
Lines added: 1, lines removed: 1

```diff
@@ -1296,5 +1311,5 @@
      }
      
-     // Step 3: Group albums by artist (same as mismatch check)
+     // Step 4: Group albums by artist (same as mismatch check)
      // This is where albums without artistId get filtered out
      const artistMap = new Map();
```

**Chunk 3**
Lines added: 1, lines removed: undefined

```diff
@@ -1328,4 +1343,5 @@
      console.log('Total albums in playlist:', sortedAlbumIds.value.length);
      console.log('Albums loaded from Spotify:', allAlbumsFromPlaylist.length);
+     console.log('Albums that failed to load (null/missing):', invalidAlbumsReport.value.nullAlbums.length);
      console.log('Albums in database:', albumsInDb.length);
      console.log('Albums with artistId (would be checked):', Array.from(artistMap.values()).reduce((sum, artist) =&gt; sum + artist.albums.length, 0));
```

</details>

</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="read_lints">
<details>
          <summary>Tool use: **read_lints** • Read lints for 1 file</summary>
      
Lint paths:

- `src/views/playlists/PlaylistSingle.vue`

Lint results


**No lint errors found**
</details>
</tool-use>

---



---

Updated the function to match the ID mismatch check logic. It:

1. **Creates a map of loaded albums by ID** to track which albums were successfully loaded from Spotify.

2. **Identifies albums missing from the loaded results** by comparing `sortedAlbumIds.value` (111 albums) with what Spotify returned. Albums not in the map failed to load and are captured in `nullAlbums`.

3. **Uses the same loop as `checkForIdMismatches`** — the `for (const playlistAlbum of allAlbumsFromPlaylist)` loop with the `if (!playlistAlbum || !playlistAlbum.id)` check.

This should identify the 5 albums filtered out by that check. The console logs will show counts at each filtering stage. Run "Check Invalid" again; it should surface those 5 albums.

---

_**User (2025-11-02 07:09Z)**_

returns no null or invalid still. add some debug logs to this code when it skips

---

_**Agent (model default, mode Agent)**_



---


Adding debug logs to the `checkForIdMismatches` function where albums are skipped:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: src/views/playlists/PlaylistSingle.vue</summary>

</details>
</tool-use>

---



---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: src/views/playlists/PlaylistSingle.vue</summary>

**Chunk 1**
Lines added: 18, lines removed: undefined

```diff
@@ -1082,7 +1082,25 @@
      const albumsInDb = [];
      const albumIdToPlaylistAlbum = new Map();
+     let skippedCount = 0;
+     const skippedAlbums = [];
+     
+     console.log('[DEBUG] Starting to process albums from playlist');
+     console.log('[DEBUG] Total albums from Spotify:', allAlbumsFromPlaylist.length);
+     console.log('[DEBUG] Total original album IDs:', sortedAlbumIds.value.length);
      
      for (const playlistAlbum of allAlbumsFromPlaylist) {
        if (!playlistAlbum || !playlistAlbum.id) {
+         skippedCount++;
+         console.warn('[DEBUG] Skipped album - null or missing id:', {
+           playlistAlbum: playlistAlbum,
+           hasPlaylistAlbum: !!playlistAlbum,
+           hasId: playlistAlbum?.id,
+           type: typeof playlistAlbum,
+           value: playlistAlbum
+         });
+         skippedAlbums.push({
+           album: playlistAlbum,
+           reason: !playlistAlbum ? 'null/undefined' : 'missing id'
+         });
          continue; // Skip null or invalid albums
        }
```

**Chunk 2**
Lines added: 5, lines removed: undefined

```diff
@@ -1096,4 +1114,9 @@
        }
      }
+     
+     console.log('[DEBUG] Albums skipped (null/missing id):', skippedCount);
+     console.log('[DEBUG] Skipped albums details:', skippedAlbums);
+     console.log('[DEBUG] Albums in database:', albumsInDb.length);
+     console.log('[DEBUG] Albums processed successfully:', albumIdToPlaylistAlbum.size);
      
      if (albumsInDb.length === 0) {
```

**Chunk 3**
Lines added: 2, lines removed: undefined

```diff
@@ -1105,4 +1128,6 @@
      // Step 3: Group albums by artist to minimize API calls
      const artistMap = new Map(); // artistId -&gt; { albums: [], artistName: string }
+     let albumsWithoutArtistId = 0;
+     const albumsWithoutArtistIdList = [];
      
      for (const album of albumsInDb) {
```

**Chunk 4**
Lines added: 20, lines removed: 2

```diff
@@ -1119,6 +1144,24 @@
          }
          artistMap.get(artistId).albums.push(album);
-       }
-     }
+       } else {
+         albumsWithoutArtistId++;
+         console.warn('[DEBUG] Album without artistId:', {
+           albumId: album.id,
+           albumName: album.name,
+           artists: album.artists,
+           artistName: artistName
+         });
+         albumsWithoutArtistIdList.push({
+           id: album.id,
+           name: album.name,
+           artists: album.artists
+         });
+       }
+     }
+     
+     console.log('[DEBUG] Albums without artistId:', albumsWithoutArtistId);
+     console.log('[DEBUG] Albums without artistId details:', albumsWithoutArtistIdList);
+     console.log('[DEBUG] Unique artists found:', artistMap.size);
+     console.log('[DEBUG] Total albums with artistId (will be checked):', Array.from(artistMap.values()).reduce((sum, artist) =&gt; sum + artist.albums.length, 0));
      
      const uniqueArtists = Array.from(artistMap.values());
```

</details>

</tool-use>

---



---

<tool-use data-tool-type="generic" data-tool-name="read_lints">
<details>
          <summary>Tool use: **read_lints** • Read lints for 1 file</summary>
      
Lint paths:

- `src/views/playlists/PlaylistSingle.vue`

Lint results


**No lint errors found**
</details>
</tool-use>

---



---

Added debug logs to the `checkForIdMismatches` function. They log:

1. **When albums are skipped** — details for each album skipped due to `null` or missing `id`, including the object and reason.

2. **Summary counts** — total albums loaded, skipped, in database, and processed.

3. **Albums without artistId** — warnings with details for each album missing an `artistId` after the database check.

4. **Final statistics** — unique artists found and total albums that will be checked.

When you run "Check for ID Mismatches", the browser console will show:
- Details for each skipped album
- Counts at each filtering stage
- Which albums don't have `artistId`

This should identify where the 5 albums are filtered out. Check the console logs when running the mismatch check.

---

_**User (2025-11-02 07:09Z)**_

ahh. it's the grouped artist that creating the final number

---

_**Agent (model default, mode Ask)**_



---


The progress counter is tracking unique artists (106), not albums (111).

- 111 albums are processed and valid
- 106 unique artists after grouping
- The mismatch check loops by unique artists, so it shows "6 of 106"

The "5 missing" isn’t albums; it’s the difference between albums (111) and unique artists (106). Some artists have multiple albums in the playlist.

To surface this in the UI:
1. Update the progress display to indicate it's counting artists, not albums
2. Modify the "Check Invalid" function to report albums that share artists (or clarify it checks by artists)
3. Add a summary showing total albums vs unique artists

Should I update the code to clarify this in the UI?

---

